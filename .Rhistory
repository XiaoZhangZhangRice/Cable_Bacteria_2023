library(knitr)
library(ggplot2)
theme_set(theme_bw())
library(emmeans)
library(multcomp)
library(PLS205)
library(lme4)
library(lmerTest)
library(multcompView)
library(car)
library(Rmisc)
library(dplyr) #https://r4ds.had.co.nz/ (Chapter 3, Chapter 5, look at filter and select)
# https://bookdown.org/ansellbr/WEHI_tidyR_course_book/
library(stringr)
library(data.table)
library(GGally)
library(formatR)
library(readxl)
library(openxlsx)
library(zoo)
library(dplyr)
library(tidyr)
library(zoo)
flux <- read_excel("../Cable_Bateria_2023_GHG_Data_Complete_21Jan2024.xlsx", sheet = 1)
flux <- read_excel("Cable_Bateria_2023_GHG_Data_Complete_21Jan2024.xlsx", sheet = 1)
str(flux)
flux <- read_excel("Cable_Bateria_2023_GHG_Data_Complete_21Jan2024.xlsx", sheet = 1)
str(flux)
flux %>%
summarise(n_dates = n_distinct(Date))
View(flux)
flux_2025 <- flux %>%
filter(Date >= as.POSIXct("2023-06-27") & Date <= as.POSIXct("2023-08-14"))
library(dplyr)
flux_2025 <- flux %>%
filter(Date >= as.POSIXct("2023-06-27") & Date <= as.POSIXct("2023-08-14"))
flux <- read_excel("Cable_Bateria_2023_GHG_Data_Complete_21Jan2024.xlsx", sheet = 1)
library(knitr)
library(ggplot2)
theme_set(theme_bw())
library(emmeans)
library(multcomp)
library(PLS205)
library(lme4)
library(lmerTest)
library(multcompView)
library(car)
library(Rmisc)
library(dplyr) #https://r4ds.had.co.nz/ (Chapter 3, Chapter 5, look at filter and select)
# https://bookdown.org/ansellbr/WEHI_tidyR_course_book/
library(stringr)
library(data.table)
library(GGally)
library(formatR)
library(readxl)
library(openxlsx)
library(zoo)
library(dplyr)
library(tidyr)
library(zoo)
library(dplyr)
flux <- read_excel("Cable_Bateria_2023_GHG_Data_Complete_21Jan2024.xlsx", sheet = 1)
str(flux)
flux %>%
summarise(n_dates = n_distinct(Date))
View(flux)
flux_2025 <- flux %>%
filter(Date >= as.POSIXct("2023-06-27") & Date <= as.POSIXct("2023-08-14"))
View(flux_2025)
flux_2023 <- flux %>%
filter(Date >= as.POSIXct("2023-06-26") & Date <= as.POSIXct("2023-08-14"))
View(flux_2023)
View(flux_2023)
flux_2023 <- flux %>%
filter(Date >= as.POSIXct("2023-06-26") & Date <= as.POSIXct("2023-08-14"))
start_date <- as.Date("2023-06-26")
end_date <- as.Date("2023-08-14")
date_seq <- seq.Date(start_date, end_date, by = "day")
interpolated <- flux_2023 %>%
group_by(Plot) %>%
complete(Date = date_seq) %>%
ungroup()
interpolated <- interpolated %>%
group_by(Plot) %>%
mutate(CH4_flux_g_ha_day = na.approx(CH4_flux_g_ha_day, rule = 2)) %>%
#mutate(N2O_g_ha_day = na.approx(N2O_g_ha_day, rule = 2)) %>%
ungroup()
flux <- read_excel("Cable_Bateria_2023_GHG_Data_Complete_21Jan2024.xlsx", sheet = 1)
str(flux)
flux %>%
summarise(n_dates = n_distinct(Date))
flux_2023 <- flux %>%
filter(Date >= as.POSIXct("2023-06-26") & Date <= as.POSIXct("2023-08-14"))
start_date <- as.Date("2023-06-26")
end_date <- as.Date("2023-08-14")
date_seq <- seq.Date(start_date, end_date, by = "day")
interpolated <- flux_2023 %>%
group_by(Plot) %>%
complete(Date = date_seq) %>%
ungroup()
interpolated <- interpolated %>%
group_by(Plot) %>%
mutate(CH4_flux_g_ha_day = na.approx(CH4_flux_g_ha_day, rule = 2)) %>%
#mutate(N2O_g_ha_day = na.approx(N2O_g_ha_day, rule = 2)) %>%
ungroup()
View(interpolated)
rice_seasonal_emissions <- interpolated %>%
group_by(Plot) %>%
summarize(total_CH4_emissions = sum(CH4_flux_g_ha_day, na.rm = TRUE))%>%
#total_N2O_emissions = sum(N2O_g_ha_day, na.rm = TRUE))
# mutate(Period_Year = "Summer_2025") %>%
#mutate(Period = "Summer") %>%
mutate(total_CH4_emissions_kg_ha = total_CH4_emissions/1000)%>%
mutate(Treatment = factor(str_sub(Plot, 2)))
View(interpolated)
rice_seasonal_emissions <- interpolated %>%
group_by(Plot) %>%
summarize(total_CH4_emissions = sum(CH4_flux_g_ha_day, na.rm = TRUE))%>%
#total_N2O_emissions = sum(N2O_g_ha_day, na.rm = TRUE))
# mutate(Period_Year = "Summer_2025") %>%
#mutate(Period = "Summer") %>%
mutate(total_CH4_emissions_kg_ha = total_CH4_emissions/1000)
View(rice_seasonal_emissions)
rice_seasonal_emissions <- interpolated %>%
group_by(Plot) %>%
summarize(total_CH4_emissions = sum(CH4_flux_g_ha_day, na.rm = TRUE))
View(rice_seasonal_emissions)
View(interpolated)
flux_2023 <- flux %>%
filter(Date >= as.POSIXct("2023-06-26") & Date <= as.POSIXct("2023-08-14"))
start_date <- as.Date("2023-06-27")
end_date <- as.Date("2023-08-14")
date_seq <- seq.Date(start_date, end_date, by = "day")
interpolated <- flux_2023 %>%
group_by(Plot) %>%
complete(Date = date_seq) %>%
ungroup()
interpolated <- interpolated %>%
group_by(Plot) %>%
mutate(CH4_flux_g_ha_day = na.approx(CH4_flux_g_ha_day, rule = 2)) %>%
#mutate(N2O_g_ha_day = na.approx(N2O_g_ha_day, rule = 2)) %>%
ungroup()
rice_seasonal_emissions <- interpolated %>%
group_by(Plot) %>%
summarize(total_CH4_emissions = sum(CH4_flux_g_ha_day, na.rm = TRUE))%>%
#total_N2O_emissions = sum(N2O_g_ha_day, na.rm = TRUE))
# mutate(Period_Year = "Summer_2025") %>%
#mutate(Period = "Summer") %>%
mutate(total_CH4_emissions_kg_ha = total_CH4_emissions/1000)
View(rice_seasonal_emissions)
rice_seasonal_emissions <- interpolated %>%
group_by(Plot) %>%
summarize(total_CH4_emissions = sum(CH4_flux_g_ha_day, na.rm = TRUE))
View(rice_seasonal_emissions)
rice_seasonal_emissions <- interpolated %>%
group_by(Plot)
View(rice_seasonal_emissions)
rice_seasonal_emissions <- interpolated %>%
group_by(Plot) %>%
summarize(total_CH4_emissions = sum(CH4_flux_g_ha_day))
View(rice_seasonal_emissions)
interpolated <- flux_2023 %>%
group_by(Plot) %>%
complete(Date = date_seq) %>%
ungroup()
flux$Plot <- as.factor(flux$Plot)
flux <- read_excel("Cable_Bateria_2023_GHG_Data_Complete_21Jan2024.xlsx", sheet = 1)
str(flux)
flux$Plot <- as.factor(flux$Plot)
flux %>%
summarise(n_dates = n_distinct(Date))
flux_2023 <- flux %>%
filter(Date >= as.POSIXct("2023-06-26") & Date <= as.POSIXct("2023-08-14"))
start_date <- as.Date("2023-06-27")
end_date <- as.Date("2023-08-14")
date_seq <- seq.Date(start_date, end_date, by = "day")
interpolated <- flux_2023 %>%
group_by(Plot) %>%
complete(Date = date_seq) %>%
ungroup()
View(interpolated)
interpolated <- interpolated %>%
group_by(Plot) %>%
mutate(CH4_flux_g_ha_day = na.approx(CH4_flux_g_ha_day, rule = 2)) %>%
ungroup()
View(interpolated)
interpolated %>%
group_by(Plot) %>%
summarize(total_CH4_emissions = sum(CH4_flux_g_ha_day))
rice_seasonal_emissions <- interpolated %>%
group_by(Plot) %>%
summarize(total_CH4_emissions = sum(CH4_flux_g_ha_day))%>%
#total_N2O_emissions = sum(N2O_g_ha_day, na.rm = TRUE))
mutate(Period_Year = "Summer_2023") %>%
mutate(Period = "Summer") %>%
mutate(total_CH4_emissions_kg_ha = total_CH4_emissions/1000)
mutate(Treatment = factor(str_sub(Plot, 4)))
rice_seasonal_emissions <- interpolated %>%
group_by(Plot) %>%
summarize(total_CH4_emissions = sum(CH4_flux_g_ha_day))%>%
#total_N2O_emissions = sum(N2O_g_ha_day, na.rm = TRUE))
mutate(Period_Year = "Summer_2023") %>%
mutate(Period = "Summer") %>%
mutate(total_CH4_emissions_kg_ha = total_CH4_emissions/1000)
View(rice_seasonal_emissions)
interpolated
flux_2023 <- flux %>%
filter(Date >= as.POSIXct("2023-06-26") & Date <= as.POSIXct("2023-08-14"))
start_date <- as.Date("2023-06-27")
end_date <- as.Date("2023-08-14")
date_seq <- seq.Date(start_date, end_date, by = "day")
interpolated <- flux_2023 %>%
group_by(Plot) %>%
complete(Date = date_seq) %>%
ungroup()
View(interpolated)
interpolated <- interpolated %>%
group_by(Plot) %>%
mutate(CH4_flux_g_ha_day = na.approx(CH4_flux_g_ha_day, rule = 2)) %>%
ungroup()
ggplot(interpolated, aes(y=CH4_flux_g_ha_day, x=Date, color = Plot)) + geom_point()
rice_seasonal_emissions <- interpolated %>%
group_by(Plot) %>%
mutate(total_CH4_emissions = sum(CH4_flux_g_ha_day, na.rm = TRUE))
View(rice_seasonal_emissions)
str(interpolated)
str(interpolated)
interpolated <- flux_2023 %>%
group_by(Plot) %>%
complete(Date = date_seq) %>%
mutate(Treatment = Treatment)
flux_2023
interpolated <- flux_2023 %>%
group_by(Plot) %>%
complete(Date = date_seq) %>%
mutate(Trt = Trt)
View(interpolated)
interpolated <- flux_2023 %>%
group_by(Plot) %>%
complete(Date = date_seq) %>%
mutate(Trt = Trt)
View(interpolated)
interpolated <- flux_2023 %>%
group_by(Plot) %>%
complete(Date = date_seq) %>%
#mutate(Trt = Trt)
ungroup()
library(knitr)
library(ggplot2)
theme_set(theme_bw())
library(emmeans)
library(multcomp)
library(PLS205)
library(lme4)
library(lmerTest)
library(multcompView)
library(car)
library(Rmisc)
library(dplyr) #https://r4ds.had.co.nz/ (Chapter 3, Chapter 5, look at filter and select)
# https://bookdown.org/ansellbr/WEHI_tidyR_course_book/
library(stringr)
library(data.table)
library(GGally)
library(formatR)
library(readxl)
library(openxlsx)
library(zoo)
library(dplyr)
library(tidyr)
library(zoo)
flux <- read_excel("Cable_Bateria_2023_GHG_Data_Complete_21Jan2024.xlsx", sheet = 1)
str(flux)
flux$Plot <- as.factor(flux$Plot)
flux %>%
summarise(n_dates = n_distinct(Date))
flux_2023 <- flux %>%
filter(Date >= as.POSIXct("2023-06-26") & Date <= as.POSIXct("2023-08-14"))
start_date <- as.Date("2023-06-27")
end_date <- as.Date("2023-08-14")
date_seq <- seq.Date(start_date, end_date, by = "day")
interpolated <- flux_2023 %>%
group_by(Plot) %>%
complete(Date = date_seq) %>%
#mutate(Trt = Trt)
ungroup()
interpolated <- interpolated %>%
group_by(Plot) %>%
mutate(CH4_flux_g_ha_day = na.approx(CH4_flux_g_ha_day, rule = 2)) %>%
ungroup()
str(interpolated)
rice_seasonal_emissions <- interpolated %>%
group_by(Plot) %>%
summarize(total_CH4_emissions = sum(CH4_flux_g_ha_day, na.rm = TRUE))%>%
#total_N2O_emissions = sum(N2O_g_ha_day, na.rm = TRUE))
mutate(Period_Year = "Summer_2023") %>%
mutate(Period = "Summer") %>%
mutate(total_CH4_emissions_kg_ha = total_CH4_emissions/1000)
View(rice_seasonal_emissions)
rice_seasonal_emissions <- interpolated %>%
group_by(Plot) %>%
summarize(total_CH4_emissions = sum(CH4_flux_g_ha_day, na.rm = TRUE))%>%
mutate(total_CH4_emissions_kg_ha = total_CH4_emissions/1000) %>%
mutate(Treatment = substr(Plot, 1, nchar(Plot) - 1))
View(rice_seasonal_emissions)
rice_seasonal_emissions <- interpolated %>%
group_by(Plot) %>%
summarize(total_CH4_emissions = sum(CH4_flux_g_ha_day, na.rm = TRUE))%>%
mutate(total_CH4_emissions_kg_ha = total_CH4_emissions/1000) %>%
mutate(Treatment = substr(as.character(Plot), 1, nchar(Plot) - 1))
rice_seasonal_emissions <- interpolated %>%
group_by(Plot) %>%
summarize(total_CH4_emissions = sum(CH4_flux_g_ha_day, na.rm = TRUE))%>%
mutate(total_CH4_emissions_kg_ha = total_CH4_emissions/1000) %>%
mutate(Treatment = str_sub(Plot, 1, -2))
View(rice_seasonal_emissions)
model <- lm(total_CH4_emissions_kg_ha~Treatment, data=rice_seasonal_emissions)
anova(model)
Treatment_means = emmeans(model,spec = 'Treatment')
Treatment_effects = contrast(Treatment_means, method = 'pairwise', adjust = "Tukey")
summary(Treatment_effects)
cld(Treatment_means)
emm_reduction <- Treatment_means %>%
mutate(C_value = emmean[Treatment == "C"],
pct_reduction = (C_value - emmean) / C_value * 100) %>%
select(Treatment, emmean, pct_reduction)
emm_reduction <- as.data.frame(Treatment_means) %>%
mutate(C_value = emmean[Treatment == "C"],
pct_reduction = (C_value - emmean) / C_value * 100) %>%
select(Treatment, emmean, pct_reduction)
emm_reduction
reduction <- as.data.frame(Treatment_means) %>%
mutate(C_value = emmean[Treatment == "C"],
pct_reduction = (C_value - emmean) / C_value * 100) %>%
select(Treatment, emmean, pct_reduction)
reduction
library(knitr)
library(ggplot2)
theme_set(theme_bw())
library(emmeans)
library(multcomp)
library(PLS205)
library(lme4)
library(lmerTest)
library(multcompView)
library(car)
library(Rmisc)
library(dplyr) #https://r4ds.had.co.nz/ (Chapter 3, Chapter 5, look at filter and select)
# https://bookdown.org/ansellbr/WEHI_tidyR_course_book/
library(stringr)
library(data.table)
library(GGally)
library(formatR)
library(readxl)
library(openxlsx)
library(zoo)
library(dplyr)
library(tidyr)
library(zoo)
flux <- read_excel("Cable_Bateria_2023_GHG_Data_Complete_21Jan2024.xlsx", sheet = 1)
str(flux)
flux$Plot <- as.factor(flux$Plot)
flux %>%
summarise(n_dates = n_distinct(Date))
flux_2023 <- flux %>%
filter(Date >= as.POSIXct("2023-06-26") & Date <= as.POSIXct("2023-08-14"))
start_date <- as.Date("2023-06-27")
end_date <- as.Date("2023-08-14")
date_seq <- seq.Date(start_date, end_date, by = "day")
interpolated <- flux_2023 %>%
group_by(Plot) %>%
complete(Date = date_seq) %>%
#mutate(Trt = Trt)
ungroup()
interpolated <- interpolated %>%
group_by(Plot) %>%
mutate(CH4_flux_g_ha_day = na.approx(CH4_flux_g_ha_day, rule = 2)) %>%
ungroup()
rice_seasonal_emissions <- interpolated %>%
group_by(Plot) %>%
summarize(total_CH4_emissions = sum(CH4_flux_g_ha_day, na.rm = TRUE))%>%
mutate(total_CH4_emissions_kg_ha = total_CH4_emissions/1000) %>%
mutate(Treatment = str_sub(Plot, 1, -2))
ggplot(interpolated, aes(y=CH4_flux_g_ha_day, x=Date, color = Plot)) + geom_point()
#ggplot(flux_2025_rice_interpolated, aes(y=N2O_g_ha_day, x=Date, color = Plot)) + geom_point()
model <- lm(total_CH4_emissions_kg_ha~Treatment, data=rice_seasonal_emissions)
anova(model)
Treatment_means = emmeans(model,spec = 'Treatment')
Treatment_effects = contrast(Treatment_means, method = 'pairwise', adjust = "Tukey")
summary(Treatment_effects)
cld(Treatment_means)
#note that the cumulative emission here is in kgCH4/ha-1
reduction <- as.data.frame(Treatment_means) %>%
mutate(C_value = emmean[Treatment == "C"],
pct_reduction = (C_value - emmean) / C_value * 100) %>%
select(Treatment, emmean, pct_reduction)
reduction
